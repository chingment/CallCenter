@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}


@section scripts{

    <script type="text/javascript">


        $(document).ready(function () {

            $('#sel_ResultCode').myChosen({ urlParams: { type: "callresultcode", businessType: 1 } });

            $('.btn-search').live('click',function(){
                search();
            });

            $('.btn-export-excel').live('click',function(){
                exportExcel();
            });
        });

        function GetParams(operate) {
            var l_Data = $("#form1").serializeArray();
            l_Data.push({ name: "Operate", value: operate });
            return l_Data;
        }

        var url = "/Report/CallResultRecord";

        function search() {
            $.lumos.postJson({
                url: url,
                isUseHandling: true,
                data: GetParams($.lumos.operateType.search),
                success: function (d) {
                    $('#reporthtml').html(d.data.html);
                }
            });

            return false;
        }

        function exportExcel() {
            $.lumos.download(url, GetParams($.lumos.operateType.exportExcel), 'post');
        }

    </script>
}

<div class="gbr-row gbr-page">
    <form id="form1" name="form1">
        <div class="search-bar">
            <div class="filter">
                <span class="filter-label">坐席：</span>
                <span class="filter-input">
                    <input type="text" class="input-control" name="SalesmanName" style="width:120px;" />
                </span>
            </div>
            <div class="filter">
                <span class="filter-label">客户姓名：</span>
                <span class="filter-input">
                    <input type="text" class="input-control" name="CustomerName" style="width:120px;" />
                </span>
            </div>
            <div class="filter">
                <span class="filter-label">电话号码：</span>
                <span class="filter-input">
                    <input type="text" class="input-control" name="PhoneNumber" style="width:120px;" />
                </span>
            </div>
            <div class="filter">
                <span class="filter-label">通话结果：</span>
                <span class="filter-input">
                    <select id="sel_ResultCode" name="ResultCode" data-placeholder="请选择" class="chosen-select" style="width:200px">
                        <option value="">请选择</option>
                    </select>
                </span>
            </div>
            <div class="filter">
                <span class="filter-label">创建时间：</span>
                <span class="filter-input">
                    <input type="text" class="input-control Wdate" id="Model_StartTime" name="StartTime" onclick="WdatePicker({ maxDate: '#F{$dp.$D(\'Model_EndTime\')||\'@DateTime.Now.ToString("yyyy-MM-dd")\'}' })" style="width:80px;" value="@DateTime.Now.ToString("yyyy-MM-dd")" />至<input type="text" class="input-control Wdate" id="Model_EndTime" name="EndTime" onclick="WdatePicker({ minDate: '#F{$dp.$D(\'Model_StartTime\')}' })" style="width:80px;" value="@DateTime.Now.ToString("yyyy-MM-dd")" />
                </span>
            </div>
            <div class="filter">
                <input type="button" value="查询" class="btn btn-search" />
                <input type="button" value="导出" class="btn btn-export-excel" />
            </div>

            <div class="filter" style="float:right">

            </div>
        </div>

        <div id="reporthtml">
            @Html.Raw(Model.TableHtml)
        </div>

    </form>
</div>

